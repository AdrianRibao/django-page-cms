{% extends "admin/change_list.html" %}
{% load adminmedia admin_list i18n gerbi_tags gerbi_admin_tags %}

{% block title %}{% trans "List of pages" %}{% endblock %}

{% block bodyclass %}change-list{% endblock %}

{% if not is_popup %}{% block breadcrumbs %}
    <div class="breadcrumbs">
    <a href="../../">{% trans "Home" %}</a> &rsaquo;
    <a href="../">{{ app_label|capfirst|escape }}</a> &rsaquo; {{ opts.verbose_name_plural|capfirst|escape }}
    </div>
{% endblock %}{% endif %}

{% block coltype %}flex{% endblock %}

{% block extrahead %}{{ block.super }}
<script type="text/javascript">var media_url = "{{MEDIA_URL}}"; var page_media_url = "{{GERBI_MEDIA_URL}}";</script>
<script type="text/javascript" src="{{ GERBI_MEDIA_URL }}javascript/jquery-ui-1.7.2.custom.min.js"></script>
<script type="text/javascript" src="{{ GERBI_MEDIA_URL }}javascript/jquery.query.js"></script>
<script type="text/javascript" src="{{ GERBI_MEDIA_URL }}javascript/pages_list.js"></script>
{% endblock %}

{% block content %}
<div id="content-main">

{% if has_add_permission %}
<ul class="object-tools"><li><a href="add/" class="addlink">{% blocktrans with name as name %}Add {{ name }}{% endblocktrans %}</a></li></ul>
{% endif %}

<div class="module" id="changelist">

{% block result_list %}
<form method="post" action="">
{% csrf_token %}
{% if action_form and actions_on_top and cl.full_result_count %}{% admin_actions %}{% endif %}

<div id="toolbar">
<form id="changelist-search" action="" method="post">
    <div>
        <label for="searchbar"><img src="{% load adminmedia %}{% admin_media_prefix %}img/admin/icon_searchbox.png" alt="{% trans "Search" %}" /></label>
        <input type="text" size="25" name="q" value="{{q}}" id="searchbar" />
        <input type="submit" name="g" value="{% trans "Go" %}" />
    </div>
</form>
</div>

<div id="page-list">
{% include "admin/gerbi/page/change_list_table.html" %}
</div>
{% if action_form and actions_on_bottom and cl.full_result_count %}{% admin_actions %}{% endif %}
</form>
{% endblock %}

{% if debug %}
<div id="debug">
  <h2>Queries</h2>
  <p>
    {{ sql_queries|length }} Quer{{ sql_queries|pluralize:"y,ies" }}
    {% ifnotequal sql_queries|length 0 %}
    (<span style="cursor: pointer;" onclick="var s=document.getElementById('debugQueryTable').style;s.display=s.display=='none'?'':'none';this.innerHTML=this.innerHTML=='Show'?'Hide':'Show';">Show</span>)
    {% endifnotequal %}
  </p>
  <table id="debugQueryTable" style="display: none;">
    <col width="1"></col>
    <col></col>
    <col width="1"></col>
    <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">SQL</th>
      <th scope="col">Time</th>
    </tr>
    </thead>
    <tbody>
    {% for query in sql_queries %}<tr class="{% cycle odd,even %}">
      <td>{{ forloop.counter }}</td>
      <td>{{ query.sql|escape }}</td>
      <td>{{ query.time }}</td>
    </tr>{% endfor %}
    </tbody>
  </table>
</div>
{% endif %}

</div>
</div>
{% endblock %}
